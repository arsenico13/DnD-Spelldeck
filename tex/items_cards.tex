\documentclass{article}
\usepackage{ifxetex}
\usepackage{fancyhdr}
\usepackage{background}
\usepackage{eso-pic}
\usepackage{xparse}
\usepackage[paperheight=8.89cm,paperwidth=6.2cm,margin=0.4cm,top=21mm,bottom=10mm,headheight=1cm]{geometry}

\backgroundsetup{
    contents={\includegraphics[width=\paperwidth,height=\paperheight]{images/background}}
}

% ===== Overlay PNG opzionale per singola card =====
\newcommand{\OverlayFile}{} % vuoto = nessun overlay
\NewDocumentCommand{\OverlaySet}{m}{\gdef\OverlayFile{#1}}
\NewDocumentCommand{\OverlayClear}{}{\gdef\OverlayFile{}}

\AddToShipoutPictureBG{%
  \AtPageLowerLeft{%
    \ifx\OverlayFile\empty\else
      \raisebox{10mm}[0pt][0pt]{%
        \parbox[b][\dimexpr\paperheight-10mm\relax][c]{\paperwidth}{%
          \centering
          \includegraphics[width=0.5\paperwidth]{\OverlayFile}%
        }%
      }%
    \fi
  }%
}

\ifxetex
\usepackage{fontspec}
\setmainfont{MrsEavesRoman}
\fi

\definecolor{headercolor}{RGB}{188,1,138}
\definecolor{linecolor}{RGB}{201,173,106}

\sloppy
\setlength{\headsep}{3mm}
\pagestyle{fancy}
\chead{\scshape\scriptsize\spellheader\\[-1.8mm]\Large\color{headercolor}\mbox{\spelltitle}}
\cfoot{\if\relax\damagetype\relax\else\scriptsize\damagetype\fi}
\setlength{\parindent}{0pt}

\NewDocumentEnvironment{spell}{O{} m m m m m m m}{
  \IfBlankTF{#1}{\OverlayClear}{\OverlaySet{#1}}
    \def\spelltitle{#2}
    \def\spellheader{#3}
    \def\itemweight{#4}
    \def\itemcost{#5}
    \def\damage{#6}
    \def\attunement{#7}
    \def\damagetype{#8}
    \begin{minipage}[t][5cm][t]{\textwidth}
    \vspace{-3mm}
    \begin{minipage}[t]{0.49\textwidth}
        \centering\footnotesize\scshape{\color{headercolor}Costo}

        \itemcost
	\end{minipage}
    \hfill
    \begin{minipage}[t]{0.49\textwidth}
        \centering\footnotesize\scshape{\color{headercolor}Tipo danno}

        \itemweight
	\end{minipage}\\[3mm]
    \begin{minipage}[t]{0.49\textwidth}
        \centering\footnotesize\scshape{\color{headercolor}Sintonia}

        \attunement
	\end{minipage}
    \hfill
    \begin{minipage}[t]{0.49\textwidth}
        \centering\footnotesize\scshape{\color{headercolor}Danno}

        \damage
	\end{minipage}
    \vspace{3mm}
    \headrule
    \vspace{3mm}
    \footnotesize
}{
    \end{minipage}
    \OverlayClear
    \newpage
}

\begin{document}
\input{items}
\end{document}
